# 3 - Linux Local Enumeration

## <mark style="color:red;">Enumerating System Information</mark>

â–ª After gaining initial access to a target system, it is always important to learn more about the system like, what OS is running as well as the OS version. This information is very useful as it gives us an idea of what we can do and what type of exploits we can run.

* What are we looking for?
  * Hostname
  * Distribution & distribution release version
  * Kernel version & architecture
  * Disk information & mounted drives
  * Installed packages/software

### **Practical Demonstration**

{% code overflow="wrap" lineNumbers="true" %}
```bash
# we used the vsftpd 2.3.4 vuln to gain initial access.

meterpreter > getuid #Return username.
meterpreter > sysinfo #Return system info like hostname, architecture, etc
shell
/bin/bash -i

shell > hostname #Return hostname.
shell > cat /etc/issue #Return distribution version
shell > cat /etc/*release #Return in-depth info about the distribution
shell > uname -a # Return hostname, kernel version/architecture.
shell > uname -r # Return kernel version.
shell > env # Display the environment variables for the current user.
shell > lscpu # Display CPU information
shell > free -h #Display RAM information
shell > df -h #List the different file systems
shell > df -ht <fileExtension> #List file systems with mentionned file extension
shell > lsblk | grep <query> #Display info about queryied storage devices/partitions
shell > dpkg -l #List installed packages on a Debian distribution.
```
{% endcode %}



## <mark style="color:red;">Enumerating Users & Groups</mark>

* After gaining initial access to a target system, it is always important to learn more about the system like, what user account you have access to and other user accounts on the system.
* What are we looking for?
  * Current user & privileges
  * Other users on the system
  * Groups

### **Practical Demonstration**

{% code overflow="wrap" lineNumbers="true" %}
```bash
shell > whoami #Return current user account
shell > groups <userName> #Return the group the user is a part of
shell > cat /etc/passwd #Display every user/service accounts on the system
#root:x:0:0:root:/root:/bin/bash --> Is a user account because a shell is specified at the end
#daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin --> Is a service account because no shell is specified
shell > who # time current user logged in.
shell > cat /etc/passwd | grep -v /nologin #Display only the user accounts
#username:x:userID:groupID:homeDirectory:shell --> passwd file explained
shell > last #Return previously logged on users
shell > lastlog #Return users that logged on the system
```
{% endcode %}



## <mark style="color:red;">Enumerating Network Information</mark>

* What are we looking for?
  * Current IP address & network adapter
  * Internal networks
  * TCP/UDP services running and their respective ports
  * Other hosts on the network

### **Practical Demonstration**

{% code overflow="wrap" lineNumbers="true" %}
```bash
meterpreter > ifconfig #Return IP interfaces
meterpreter > netstat #Return currently TCP/UDP running services
meterpreter > route #Return the routing table
meterpreter > arp #Display the arp cache

shell > ip a s #Return IP interfaces
shell > cat /etc/networks # Display list of interfaces and configurations
shell > cat /etc/hostname #Display the hostname
shell > cat /etc/hosts #Display the hosts file
shell > cat /etc/resolv.conf #Display the DHCP server informations
shell > arp -a #Display other hosts on the victim same network subnet.
```
{% endcode %}



## <mark style="color:red;">Enumerating Processes & Cron Jobs</mark>

* After gaining initial access to a target system, it is always important to learn more about the system like, what processes, services and scheduled tasks are currently running.
* What are we looking for?
  * Running services
  * Cron Jobs

### **Practical Demonstration**

{% code overflow="wrap" lineNumbers="true" %}
```bash
meterpreter > ps #List running processes
meterpreter > pgrep <query> #Search for a particular running process

shell > ps #List running processes
shell > ps aux #List running processes and in-depth informations
shell > top #Dynamically list running processes and in-depth informations
shell > crontab -l #Display cronjobs for the current user
shell > ls -al /etc/cron* #Display all cronjobs on the system
shell > cat /etc/cron* #Display all the cronjobs files on the system
```
{% endcode %}



## <mark style="color:red;">Automating Linux Local Enumeration</mark>

* In addition to performing local enumeration manually, we can also automate the process with the help of a few scripts and MSF modules.
* While local enumeration techniques/commands are important to know, as a penetration tester, you will need to be time efficient. As a result, you will need to learn how to utilize various automated enumeration scripts.
* In addition to automating the process of enumerating information like system information, users & groups etc, these automated enumeration scripts will also provide you with additional information regarding the target system like privileges escalation vulnerabilities, locally stored passwords, etc.

### **Linux Local Enum Scripts**

* LinEnum - LinEnum is a simple bash script that automates common Linux local enumeration checks in addition to identifying privilege escalation vulnerabilities.
  * GitHub Repo: [https://github.com/rebootuser/LinEnum](https://github.com/rebootuser/LinEnum)

### **Practical Demonstration**

{% code overflow="wrap" lineNumbers="true" %}
```bash
# Shellshock (cgi script)

msf5 > use post/linux/gather/enum_configs # Enumerate configurations files of applications and services.
msf5 > use post/linux/gather/enum_networks #Enumerate network informations like interfaces, routing tables, etc
msf5 > use post/linux/gather/enum_system #Enumerate system and user information
msf5 > use post/linux/gather/checkvm #Check if the target system is a VM

# linEnum script
#
```
{% endcode %}

### Copying the LinEnum Script into the Exam Lab Environment

* goto the github page
* open the LinEnum.sh file, click raw, copy the script.
* press ctrl + shift + alt, paste the script in the clipboard.
* create a new .sh file, then paste it.
* grant execute perm (chmod +x).
* upload to victim.

