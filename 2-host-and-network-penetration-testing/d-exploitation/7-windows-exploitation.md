# 7 - Windows Exploitation

## <mark style="color:red;">Windows Black Box Penetration Test</mark>

### **Black Box Pentest**

* A Black box penetration test is a security assessment whereby the penetration tester is not provided with any information regarding the target system or network (No IP ranges, system information or default credentials are provided).
* The objective of a Black box penetration test is to accurately test the security of a system or network as an external unprivileged adversary.
* This approach is very useful as it demonstrates how an external attacker with no inside knowledge would compromise a company's systems or networks.

### **Penetration Testing Phases**

* The following diagram outlines the various phases involved in a typical penetration test.

### **Black Box Methodology:**

* Host discovery
* Port scanning & enumeration
* Vulnerability detection/scanning
* Exploitation
* Manual
* Automated
* Post Exploitation
* Privilege Escalation
* Persistence
* Dumping Hashes

### **Scenario & Scope**

* You have just begun your first job as a Junior Penetration Tester and have been assigned to assist in performing a penetration test on a client's network.
* The pentest lead has assigned you to gain access/exploit a host running Windows Server 2008.
* Your primary objectives are:
  * Identify services running on the target.
  * Identify vulnerabilities within the services.
  * Exploit these vulnerabilities to obtain an initial foothold.



## Practical Demonstration

#### <mark style="color:yellow;">Black Box Port Scanning & Enumeration</mark>

{% code overflow="wrap" lineNumbers="true" %}
```bash
# discovering hosts in the network, we can get the target ip 
cat /etc/hosts # ping it to confirm reachability.

# nmap scan 
nmap -sV $ip # scan 1000 commonly used ports.
nmap -T4 -PA -sC -sV -p 1-10000 $ip -oX nmap_10k # -PA-ack scan, -oX-xml format.
nc -nv $ip 21 # to get banner, but no luck.
# we opened the "http://$ip/4848" on the web browser to take a look at the service, $ip/8080, $ip/9200 etc.

# we get a lot of http service ports based on the nmap scan on line 6, so we view each of them.

service postgresql start && msfconsole # create a workspace for the target (Win2k8).
db_import /path_to_nmapscan # import the scan.
# if you want the OS name to be specified correctly in the "os_name" column in msfconsole db a trick is to use the SMB version module.
search smb_version
use 0
options
set RHOSTS $ip
run
hosts # host name is now specified correctlly.
services # view all imported services.

# we can also do a comprehensive scan
nmap -sV -T4 -PA -sC -p 1-65535 $ip -oV nmap_All # didnt do.
nmap -sU -sV $ip # udp scan.
```
{% endcode %}



#### <mark style="color:yellow;">1 - Targeting Microsoft IIS FTP (port 21)</mark>

{% code overflow="wrap" lineNumbers="true" %}
```bash
```
{% endcode %}































