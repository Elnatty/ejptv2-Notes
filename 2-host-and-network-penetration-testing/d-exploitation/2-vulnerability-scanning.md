# 2 - Vulnerability Scanning

## <mark style="color:red;">Banner Grabbing</mark>

* Banner grabbing is an information gathering technique used by penetration testers to enumerate information regarding the target operating system as well as the services that are running on its open ports.
* The primary objective of banner grabbing is to identify the service running on a specific port as well as the service version.
* Banner grabbing can be performed through various techniques:
  * Performing a service version detection scan with Nmap.
  * Connecting to the open port with Netcat.
  * Authenticating with the service (If the service supports authentication), for example; SSH, FTP, Telnet etc.

### **Practical Demonstration**

```bash
nmap -sV -O <targetIP> #Scan the target with service version scan and operating system detection.

ls /usr/share/nmap/scripts | grep banner # search for nmap specific script.
nmap -sV --script=banner <targetIP> #Perform an nmap scan with a script that grab banners
ls -al /usr/share/nmap/script | grep <query> #Search for an nmap scan

# a more reliable tool.
# using netcat to perform banner grabbing.
nc <targetIP> <port> #Use Netcat to return the banner on the specified port.
nc $ip 22
```





## <mark style="color:red;">Vulnerability Scanning With Nmap Scripts</mark>

### **Practical Demonstration**

```bash
#https://nmap.org/book/nse.html Is a great ressource for the Nmap Scripting Engine (NSE) documentation

#For example, nmap script used to detect if a target is vulnerable to shellshock:
# shellshock vuln essentially affecty cgi script.
# in this case the victim location at "$ip/gettime.cgi"
# nmap -sV -p 80 --script=http-shellshock --script-args "http-shellshock.uri/<CGIscript>" $victim_ip
nmap -sV -p 80 --script=http-shellshock --script-args "http-shellshock.uri/gettime.cgi" $ip
```





## <mark style="color:red;">Vulnerability Scanning With Metasploit</mark>

### **Practical Demonstration**

```bash
searchsploit <query> #Perform an exploit search with searchsploit.

msf6 > search <query> #Perform a module search with MSF
msf6 > use auxiliary/scanner/smb/smb_ms17_010 #Auxiary module that check if the target is vulnerable to the EternalBlue vulnerability
```



