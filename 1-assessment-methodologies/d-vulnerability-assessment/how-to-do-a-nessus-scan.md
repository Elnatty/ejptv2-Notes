# How to do a Nessus Scan

**Step 1:** Open the lab link to access the Kali GUI instance.

![1](https://assets.ine.com/content/pta-labs/9\_nessus/1.png)

**Step 2:** Launch the browser and open Nessus dashboard.

Nessus dashboard can be accessed by visiting the following URL:

**URL:**

```
https://localhost:8834/
```

![2](https://assets.ine.com/content/pta-labs/9\_nessus/2.png)

**Note:** If you visit [http://localhost:8834/](http://localhost:8834/) instead of **HTTPS**, then you would get the following page:

![2\_1](https://assets.ine.com/content/pta-labs/9\_nessus/2\_1.png)

Once Nessus dashboard opens up, enter the credentials provided in the challenge description:

**Username:** admin **Password:** adminpasswd

Upon successful authentication, you would see the following screen:

![2\_2](https://assets.ine.com/content/pta-labs/9\_nessus/2\_2.png)

**Step 3:** Scan the target machine at [demo.ine.local](http://demo.ine.local/) using Nessus.

In the text area labeled as **Targets**, enter the target we wish to analyze using Nessus, that is, [demo.ine.local](http://demo.ine.local/):

![3](https://assets.ine.com/content/pta-labs/9\_nessus/3.png)

Once the target has been entered, you should see the following screen:

![3\_1](https://assets.ine.com/content/pta-labs/9\_nessus/3\_1.png)

This is the result of the Host Discovery scan performed by Nessus. It shows the DNS name as well as the IP address of the target machine.

Select the only host listed and click on the **Run Scan** button:

![3\_2](https://assets.ine.com/content/pta-labs/9\_nessus/3\_2.png)

This would start a **Basic Network Scan** by default:

![3\_3](https://assets.ine.com/content/pta-labs/9\_nessus/3\_3.png)

Notice that we can see the name, start time and the status of the scan on the right.

Once the scan is finished, you would notice the following screen:

![3\_4](https://assets.ine.com/content/pta-labs/9\_nessus/3\_4.png)

You can see the scan status (**Completed**), scan duration as well as the vulnerabilities discovered during this scan.

In this particular scan, 2 medium severity vulnerabilities were discovered. To get more details about the vulnerabilities, click on the horizontal colored bar containing the vulnerabilities of different severity and their respective counts.

That would open up the following page:

![3\_5](https://assets.ine.com/content/pta-labs/9\_nessus/3\_5.png)

Here you can notice the different vulnerabilities discovered by this scan. To get more details about a specific vulnerability, simply click on the entry for it and you would be taken to a page like this:

![3\_6](https://assets.ine.com/content/pta-labs/9\_nessus/3\_6.png)

This page would show you the vulnerability name, it's severity, a short description, a remediation strategy, related advisories/links.

The output section on the same page might show you the steps or the URL to exploit or confirm the vulnerability as well:

![3\_7](https://assets.ine.com/content/pta-labs/9\_nessus/3\_7.png)

Head back to the previous page containing all the identified vulnerabilities in the scan by clicking on the **Back to Vulnerabilities** link:

![3\_8](https://assets.ine.com/content/pta-labs/9\_nessus/3\_8.png)

**Step 4:** Download the vulnerabilities report for the basic network scan.

We can even export the results in the form of a report which can be submitted to your clients after a pentest, while reporting your findings.

This can be done by clicking on the **Report** button on the top-right corner of the page containing all the discovered vulnerabilities for the scan under consideration:

![4](https://assets.ine.com/content/pta-labs/9\_nessus/4.png)

You will get the following options to generate a report:

![4\_1](https://assets.ine.com/content/pta-labs/9\_nessus/4\_1.png)

We will go with the defaults for now (a PDF report containing the complete list of vulnerabilities by host) and click on the **Generate Report** button.

![4\_2](https://assets.ine.com/content/pta-labs/9\_nessus/4\_2.png)

Once the report is downloaded, it should look something like this:

![4\_3](https://assets.ine.com/content/pta-labs/9\_nessus/4\_3.png)

**Step 5:** Performing a custom scan using Nessus.

Now that we have performed a basic scan using Nessus, let's perform a custom scan.

The scan we will be performing would require some configuration from our end, but that would be worthy at the end since we would control the different parameters of the scan instead of going with the default available templates.

So to create a custom scan, let's visit the **My Scans** tab located in the left pane:

![5](https://assets.ine.com/content/pta-labs/9\_nessus/5.png)

Before we create a custom scan, let's see the results of another scan that's shown in bold.

![5\_1](https://assets.ine.com/content/pta-labs/9\_nessus/5\_1.png)

**Information:** When you start Nessus, it performs 2 basic scans by default. For one of the scans, we already saw the results. The results for the second scan were not yet explored. That's why they are still in bold, as in they are unread yet!

Let's check these results as well:

![5\_2](https://assets.ine.com/content/pta-labs/9\_nessus/5\_2.png)

As you can see in the above image, it's a simple host discovery scan which took only few seconds to conclude.

Now let's get back to the route we were on and create a new scan:

![5\_3](https://assets.ine.com/content/pta-labs/9\_nessus/5\_3.png)

Once you are back on the **My Scans** screen, click on the **New Scan** button just below the navbar:

![5\_4](https://assets.ine.com/content/pta-labs/9\_nessus/5\_4.png)

For the sake of this lab, since we have **Mutillidae** running on the target machine, the obvious scan template should be **Web Application Tests**. But instead of going with this pre-available template, we will create a custom vulnerability scanning template using the **Advanced Scan** template.

![5\_5](https://assets.ine.com/content/pta-labs/9\_nessus/5\_5.png)

Select the **Advanced Scan** template and configure its settings:

![5\_6](https://assets.ine.com/content/pta-labs/9\_nessus/5\_6.png)

Fill in a suitable name and description for the template and specify the target you wish to scan. For this lab, the target would be [demo.ine.local](http://demo.ine.local/).

![5\_7](https://assets.ine.com/content/pta-labs/9\_nessus/5\_7.png)

Next, we will configure the **DISCOVERY** -> **Host Discovery** settings:

![5\_8](https://assets.ine.com/content/pta-labs/9\_nessus/5\_8.png)

We will uncheck the first option (which would test our local host for vulnerability scanning) and we will check the second option, (which would make our scans more faster by trading-off accuracy).

![5\_9](https://assets.ine.com/content/pta-labs/9\_nessus/5\_9.png)

Going with these options should be okay for our simple scenario and the options you might require would depend on the target/scenario you have. For instance, while scanning the local machine for any vulnerabilities, you would want to keep the first option checked. And if you wish to have reliability and reduce the false positives in your scans, then second option must be checked as well!

Next, we will configure the **DISCOVERY** -> **Port Scanning** settings:

![5\_10](https://assets.ine.com/content/pta-labs/9\_nessus/5\_10.png)

Let's check the **TCP** option in the **Network Port Scanners** section in order to perform a more accurate scan:

![5\_11](https://assets.ine.com/content/pta-labs/9\_nessus/5\_11.png)

Next, we will configure the **ASSESSMENT** -> **General** settings:

![5\_12](https://assets.ine.com/content/pta-labs/9\_nessus/5\_12.png)

Let's check the`Perform thorough tests (may disrupt your network or impact scan speed)`option:

![5\_13](https://assets.ine.com/content/pta-labs/9\_nessus/5\_13.png)

Next, we will configure the **ASSESSMENT** -> \*\* Web Applications\*\* settings:

![5\_14](https://assets.ine.com/content/pta-labs/9\_nessus/5\_14.png)

Toggle the **Scan web applications** option:

![5\_15](https://assets.ine.com/content/pta-labs/9\_nessus/5\_15.png)

Now, let's save the configuration we have so far. Scroll down and click on the **Save** button:

![5\_16](https://assets.ine.com/content/pta-labs/9\_nessus/5\_16.png)

Now click on the **My Scans** on the left panel and you should see the scan you just created in the listing:

![5\_17](https://assets.ine.com/content/pta-labs/9\_nessus/5\_17.png)

**Step 6:** Running the newly configured advanced scan.

Now it's time to run the newly configured scan and see what all vulnerabilities we can get from Nessus!

Click on the (greyed out) play button in front of the scan template we just configured, highlighted in the following image:

![6](https://assets.ine.com/content/pta-labs/9\_nessus/6.png)

Now our scan should be running:

![6\_1](https://assets.ine.com/content/pta-labs/9\_nessus/6\_1.png)

Click on the scan entry and that should take us to the details page for this scan:

![6\_2](https://assets.ine.com/content/pta-labs/9\_nessus/6\_2.png)

Here we can see the different vulnerabilities, categorized by their severity as well the scan status and the timing details (when the scan got started, when it ended \[if it ended], and the time elapsed \[again, it's shown once the scan ends]).

To get more details on the discovered vulnerabilities, click on the horizontal bar listing the vulnerabilities. That should take us to the following page:

![6\_3](https://assets.ine.com/content/pta-labs/9\_nessus/6\_3.png)

Now click on let's say the very first entry on the page, which is **Phpmyadmin (Multiple Issues)** in our case.

![6\_4](https://assets.ine.com/content/pta-labs/9\_nessus/6\_4.png)

Notice that there are 3 vulnerabilities in here and 2 of them are of HIGH severity!

Let's dig in and check the details on the first HIGH severity vulnerability among these:

![6\_5](https://assets.ine.com/content/pta-labs/9\_nessus/6\_5.png)

This page shows more details on the selected vulnerability and the output section even lists the URL which we can try out to verify if this vulnerability actually exists!

Let's open the specified URL [http://demo.ine.local/phpmyadmin/](http://demo.ine.local/phpmyadmin/):

![6\_6](https://assets.ine.com/content/pta-labs/9\_nessus/6\_6.png)

Indeed we have an unprotected phpMyAdmin page! Feel free to take your time and exploit the target machine using the unprotected phpMyAdmin page.

We will instead focus on analyzing the results of Nessus. So let's go back to the vulnerabilities for this scan:

![6\_7](https://assets.ine.com/content/pta-labs/9\_nessus/6\_7.png)

![6\_8](https://assets.ine.com/content/pta-labs/9\_nessus/6\_8.png)

Let's check one more vulnerability entry:

![6\_9](https://assets.ine.com/content/pta-labs/9\_nessus/6\_9.png)

In this case, there was a Git repository served by the Web Server!

![6\_10](https://assets.ine.com/content/pta-labs/9\_nessus/6\_10.png)

The repository URL is shown in the **Output** section in the above image.

Let's verify if that's the case:

![6\_11](https://assets.ine.com/content/pta-labs/9\_nessus/6\_11.png)

And indeed, there is an exposed git repository! And notice that this repository doesn't seems like a normal git repository that you normally clone from websites like Github. And Nessus's output already reported that to us.

Now let's head back to the vulnerabilities page. So Nessus found these vulnerabilities for **Mutillidae** web application:

![6\_12](https://assets.ine.com/content/pta-labs/9\_nessus/6\_12.png)

**Step 7:** Exporting the results of the custom scan.

Now let's export the findings in the form of an HTML page. Click on **Report** button just below the navbar.

![7](https://assets.ine.com/content/pta-labs/9\_nessus/7.png)

We will set **HTML** as the **Report Format** and the **Detailed Vulnerabilities by Host** option for the report template, as shown in the above image. And now we can generate the report by clicking the **Generate Report** button.

The report should look something like this:

![7\_1](https://assets.ine.com/content/pta-labs/9\_nessus/7\_1.png)

If you scroll down, you would notice the **Host Information** as well as the various **Vulnerabilities** discovered by this scan. And the remediations are also included in the details.

![7\_2](https://assets.ine.com/content/pta-labs/9\_nessus/7\_2.png)

Scrolling through the list, you can see the information on the different vulnerabilities reported by the configured custom Nessus scan:

![7\_3](https://assets.ine.com/content/pta-labs/9\_nessus/7\_3.png)

In some cases, there is an output section as well which lists the URL or the output of importance for the listed vulnerability, as shown for **Browsable Web Directories** vulnerability:

![7\_4](https://assets.ine.com/content/pta-labs/9\_nessus/7\_4.png)

**And that's how we can carry out basic as well as advanced (and custom-tailored) vulnerability scans using Nessus!**
